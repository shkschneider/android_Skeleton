apply plugin: 'com.android.library'
apply plugin: 'kotlin-android'
apply plugin: 'org.jetbrains.dokka-android'

Properties versionProperties = new Properties()
def versionPropertiesFile = file('version.properties')
if (versionPropertiesFile.exists()) versionProperties.load(new FileInputStream(versionPropertiesFile))
def androidDefaultConfigVersionCode = (versionProperties['versionCode'] ?: "0").toInteger() + 1
versionProperties['versionCode'] = androidDefaultConfigVersionCode.toString()
versionProperties.store(versionPropertiesFile.newWriter(), null)

android {
    compileSdkVersion 27
    buildToolsVersion '27.0.3'

    defaultConfig {
        minSdkVersion 16 // Jelly Bean 4.1.x
        targetSdkVersion 27
        versionCode androidDefaultConfigVersionCode
        versionName "${versions.skeleton}"
        // setProperty('archivesBaseName', "skeleton-$versionName")
        renderscriptTargetApi 19
        renderscriptSupportModeEnabled true
    }
    defaultPublishConfig 'release'
    lintOptions {
        checkReleaseBuilds true
        abortOnError false
    }
    // publishNonDefault true
    sourceSets {
        main.java.srcDirs += 'src/main/kotlin'
    }
}

dependencies {
    implementation "com.android.support:design:${versions.support}"
    implementation "com.android.support:palette-v7:${versions.support}"
    implementation "com.android.support:recyclerview-v7:${versions.support}"
    implementation "com.android.support:preference-v14:${versions.support}"
    implementation 'com.android.volley:volley:1.0.0'

    implementation 'com.google.code.gson:gson:2.8.1'

    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk${versions.java}:${versions.kotlin}"
}

// ./build/dokka/skeleton/index.html
task doc(type: org.jetbrains.dokka.gradle.DokkaAndroidTask) {
    moduleName = 'skeleton'
    outputFormat = 'html'
    outputDirectory = "$buildDir/dokka"
    jdkVersion = versions.java
    skipEmptyPackages = true
    includeNonPublic = false
    reportUndocumented = false
    noStdlibLink = false
    externalDocumentationLink {
        url = new URL('https://developer.android.com/reference/')
        packageListUrl = new URL('https://developer.android.com/reference/package-list')
    }
    externalDocumentationLink {
        url = new URL('https://developer.android.com/reference/')
        packageListUrl = new URL('https://developer.android.com/reference/android/support/package-list')
    }
}
